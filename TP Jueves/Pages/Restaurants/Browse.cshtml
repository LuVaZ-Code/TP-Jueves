@page
@model TP_Jueves.Pages.Restaurants.BrowseModel
@{
    ViewData["Title"] = "Restaurantes";
}

<!-- HERO SECTION -->
<section class="hero" style="margin-bottom: 2rem;">
    <h1>Restaurantes Disponibles</h1>
    <p>Descubre y reserva en nuestros restaurantes asociados</p>
</section>

<!-- BUSCADOR -->
<div style="max-width: 600px; margin: 0 auto 2rem; padding: 1.5rem; background: white; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
    <form method="get" novalidate>
        <div class="input-group" style="gap: 0.5rem;">
            <input type="text" name="searchTerm" class="form-control" placeholder="Buscar por nombre, descripcion o ubicacion..." value="@Model.SearchTerm" />
            <button type="submit" class="btn btn-primary">
                <i class="fas fa-search"></i> Buscar
            </button>
            @if (!string.IsNullOrEmpty(Model.SearchTerm))
            {
                <a asp-page="Browse" class="btn btn-secondary">Limpiar</a>
            }
        </div>
    </form>
</div>

@if (Model.Restaurantes.Any())
{
    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); gap: 2rem;">
        @foreach (var restaurante in Model.Restaurantes)
        {
            <div class="card" style="display: flex; flex-direction: column;">
                <div style="background: linear-gradient(135deg, #e74c3c 0%, #ec7063 100%); color: white; padding: 1.5rem; border-radius: 12px 12px 0 0;">
                    <h5 style="margin: 0; font-size: 1.5rem; font-weight: 700;">@restaurante.Nombre</h5>
                    <p style="margin: 0.5rem 0 0; font-size: 0.95rem; opacity: 0.95;">@restaurante.Direccion</p>
                </div>

                <div class="card-body" style="flex: 1; display: flex; flex-direction: column;">
                    <p class="card-text" style="color: #7f8c8d; margin-bottom: 1.5rem; flex: 1;">
                        @if (!string.IsNullOrEmpty(restaurante.Descripcion))
                        {
                            @restaurante.Descripcion
                        }
                        else
                        {
                            <em>Sin descripcion disponible</em>
                        }
                    </p>

                    <div style="background: #f9f9f9; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem;">
                        <p style="margin: 0.5rem 0; font-size: 0.9rem;">
                            <strong>Telefono:</strong> @restaurante.Telefono
                        </p>
                        <p style="margin: 0.5rem 0; font-size: 0.9rem;">
                            <strong>Email:</strong> @restaurante.Email
                        </p>
                        <p style="margin: 0.5rem 0; font-size: 0.9rem;">
                            <strong>Mesas:</strong> @(restaurante.Mesas?.Count ?? 0)
                        </p>
                    </div>

                    <div class="btn-group" style="width: 100%;">
                        <a asp-page="Details" asp-route-id="@restaurante.Id" class="btn btn-primary" style="flex: 1;">
                            <i class="fas fa-eye"></i> Ver Detalles
                        </a>
                        @if (User?.Identity?.IsAuthenticated ?? false)
                        {
                            <a asp-page="/Reserve" asp-route-restauranteId="@restaurante.Id" class="btn btn-success" style="flex: 1;">
                                <i class="fas fa-calendar-plus"></i> Reservar
                            </a>
                        }
                        else
                        {
                            <a asp-page="/Account/Login" class="btn btn-secondary" style="flex: 1;">
                                <i class="fas fa-sign-in-alt"></i> Ingresar
                            </a>
                        }
                    </div>
                </div>
            </div>
        }
    </div>
}
else
{
    <div style="text-align: center; padding: 3rem;">
        <div style="font-size: 3rem; margin-bottom: 1rem;">??</div>
        <div class="alert alert-warning" role="alert" style="display: inline-block; border-radius: 12px;">
            <p style="margin: 0; font-size: 1.1rem;">
                @if (!string.IsNullOrEmpty(Model.SearchTerm))
                {
                    <span>No se encontraron restaurantes que coincidan con "<strong>@Model.SearchTerm</strong>"</span>
                }
                else
                {
                    <span>No hay restaurantes disponibles en este momento.</span>
                }
            </p>
        </div>
    </div>
}

<div style="margin-top: 2rem; text-align: center;">
    <a asp-page="/Index" class="btn btn-secondary">
        <i class="fas fa-arrow-left"></i> Volver al Inicio
    </a>
</div>
